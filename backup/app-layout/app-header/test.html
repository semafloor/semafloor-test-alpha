<!doctype html><html><head><meta charset="UTF-8"><title>test for app-header</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><script src="../../test-fixture/test-fixture-mocha.js"></script><link rel="import" href="../../test-fixture/test-fixture.html"><link rel="import" href="../app-toolbar/app-toolbar.html"><link rel="import" href="app-header.html"><style>body{margin:0;padding:0}app-header{position:fixed;top:0;left:0;width:100%;background:green}.content{width:1px;height:3000px;background-color:red}</style></head><body><test-fixture id="testHeader"><template><div><app-header><app-toolbar></app-toolbar><app-toolbar><div title spacer>Title</div></app-toolbar></app-header><div class="content"></div></div></template></test-fixture><script>function scrollTestHelper(e,s){function t(){var e=s.shift();e&&(e.callback(),s.length>0&&l())}function l(){var l=e===window?e.pageYOffset:e.scrollTop;s[0].y===l?t():e===window?e.scrollTo(0,s[0].y):e.scrollTop=s[0].y}s.length>0&&(e.addEventListener("scroll",t),l())}function assertHeaderIsFullSized(e){var s=e.getBoundingClientRect();assert.equal(s.top,0),assert.equal(s.bottom,s.height)}function assertHeaderIsCondensed(e){var s=e.getBoundingClientRect();assert.equal(s.top+s.height,s.bottom)}function assertHeaderIsHidden(e){var s=e.getBoundingClientRect();assert.isBelow(s.bottom,0)}suite("basic features",function(){var e,s,t,l;setup(function(){e=fixture("testHeader"),s=e.querySelector("app-header"),t=e.querySelector("app-toolbar"),l={setUp:sinon.spy(),tearDown:sinon.spy(),run:sinon.spy()},Polymer.AppScrollEffects={"test-effect":l}}),test("default values",function(){assert.isFalse(s.condenses),assert.isFalse(s.fixed),assert.isFalse(s.reveals),assert.isFalse(s.shadow)}),test("condenses",function(e){s.condenses=!0,flush(function(){scrollTestHelper(s.scroller,[{y:0,callback:function(){assertHeaderIsFullSized(s)}},{y:t.offsetHeight,callback:function(){assertHeaderIsCondensed(s)}},{y:10*t.offsetHeight,callback:function(){assertHeaderIsHidden(s)}},{y:5*t.offsetHeight,callback:function(){assertHeaderIsHidden(s)}},{y:0,callback:function(){assertHeaderIsFullSized(s),e()}}])})}),test("fixed",function(e){s.fixed=!0,flush(function(){scrollTestHelper(s.scroller,[{y:0,callback:function(){assertHeaderIsFullSized(s)}},{y:10*t.offsetHeight,callback:function(){assertHeaderIsFullSized(s),e()}}])})}),test("reveals",function(e){s.reveals=!0,flush(function(){scrollTestHelper(s.scroller,[{y:0,callback:function(){assertHeaderIsFullSized(s)}},{y:10*t.offsetHeight,callback:function(){assertHeaderIsHidden(s)}},{y:5*t.offsetHeight,callback:function(){assertHeaderIsFullSized(s),e()}}])})}),test("condenses and reveals",function(e){s.condenses=!0,s.reveals=!0,flush(function(){scrollTestHelper(s.scroller,[{y:0,callback:function(){assertHeaderIsFullSized(s)}},{y:t.offsetHeight,callback:function(){assertHeaderIsCondensed(s)}},{y:10*t.offsetHeight,callback:function(){assertHeaderIsHidden(s)}},{y:5*t.offsetHeight,callback:function(){assertHeaderIsCondensed(s)}},{y:0,callback:function(){assertHeaderIsFullSized(s),e()}}])})}),test("condenses and fixed",function(e){s.condenses=!0,s.fixed=!0,flush(function(){scrollTestHelper(s.scroller,[{y:0,callback:function(){assertHeaderIsFullSized(s)}},{y:t.offsetHeight,callback:function(){assertHeaderIsCondensed(s)}},{y:10*t.offsetHeight,callback:function(){assertHeaderIsCondensed(s),e()}}])})}),test("simple effect",function(e){s.effects="test-effect",flush(function(){scrollTestHelper(s.scroller,[{y:0,callback:function(){assert.isTrue(l.setUp.called),assert.deepEqual(l.run.lastCall.args,[0,0])}},{y:t.offsetHeight,callback:function(){assert.deepEqual(l.run.lastCall.args,[1,64])}},{y:2*t.offsetHeight,callback:function(){assert.deepEqual(l.run.lastCall.args,[2,128])}},{y:3*t.offsetHeight,callback:function(){assert.deepEqual(l.run.lastCall.args,[2.078125,133])}},{y:4*t.offsetHeight,callback:function(){assert.deepEqual(l.run.lastCall.args,[2.078125,133]),s.effects="",assert.isTrue(l.tearDown.called),e()}}])})}),test("effect with config",function(e){var a={startsAt:.5,endsAt:.75};s.effects="test-effect",s.effectsConfig={"test-effect":a},flush(function(){scrollTestHelper(s.scroller,[{y:0,callback:function(){assert.isTrue(l.setUp.called),assert.deepEqual(l.setUp.lastCall.args,[a]),assert.deepEqual(l.run.lastCall.args,[0,0])}},{y:32,callback:function(){assert.deepEqual(l.run.lastCall.args,[0,32])}},{y:40,callback:function(){assert.deepEqual(l.run.lastCall.args,[.5,40])}},{y:48,callback:function(){assert.deepEqual(l.run.lastCall.args,[1,48])}},{y:t.offsetHeight,callback:function(){assert.deepEqual(l.run.lastCall.args,[2,64]),s.effects="",assert.isTrue(l.tearDown.called),e()}}])})})});</script></body></html>