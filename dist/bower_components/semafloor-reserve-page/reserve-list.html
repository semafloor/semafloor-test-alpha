<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="reserve-list-theme.html">

<link rel="import" href="../iron-list/iron-list.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-media-query/iron-media-query.html">

<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<link rel="import" href="../paper-menu/paper-menu.html">
<link rel="import" href="../paper-item/paper-icon-item.html">
<link rel="import" href="../paper-toast/paper-toast.html">

<link rel="import" href="../firebase-element/firebase-collection.html">

<link rel="import" href="../neon-animation/animations/transform-animation.html">

<dom-module id="reserve-list">
  <template strip-whitespace>
    <style include="reserve-list-theme"></style>

    <iron-media-query
      query="(max-width: 640px)"
      query-matches="{{_isPhone}}"></iron-media-query>
    <iron-media-query
      query="(min-width: 1280px)"
      query-matches="{{_isDesktop}}"></iron-media-query>

    <firebase-collection id="listAjax"
      location="[[_location]]" data="{{_reservations}}" on-firebase-value="_onFirebaseValue">
    </firebase-collection>

    <template is="dom-if" if="[[_isReservationsEmpty(_reservations)]]" restamp="true" strip-whitespace>
      <div class="empty-tab">
        <iron-icon icon="icons:done-all"></iron-icon>
        Reservation list is empty!
      </div>
    </template>

    <template is="dom-if" if="[[!_isReservationsEmpty(_reservations)]]" restamp="true" strip-whitespace>
      <iron-list id="reserveList" items="[[_reservations]]">
        <template strip-whitespace>
          <div class="reserve-item" aria-expanded$="[[_isExpanded(index)]]" aria-controls$="[[_isCollapsible(index)]]" on-tap="_toggle">
            <div class="item-container">
              <div class="item-left">
                [[item.roomInfo.room]]
                <div class="">[[item.roomInfo.site]]</div>
              </div>

              <div class="item-right">
                [[item.fromTime]] - [[item.toTime]]
                <div class="">[[item.subject]]</div>
              </div>

              <paper-icon-button icon="icons:more-vert" class="more-options" on-tap="_optionsMenu"></paper-icon-button>
            </div>

            <div id$="[[_isCollapsible(index)]]" class="collapsible-items">
              <div class="collapsible-item">
                Reserved By
                <div>[[item.person]]</div>
              </div>
              <div class="collapsible-item">
                Requestor
                <div>[[item.requestor]]</div>
              </div>
              <div class="collapsible-item">
                Remarks
                <div>[[item.remarks]]</div>
              </div>
              <div class="collapsible-item">
                Reserved on
                <div>[[item.reservedDate]]</div>
              </div>
              <div class="collapsible-item">
                Room reserved
                <div>[[item.roomInfo.room]]</div>
              </div>
              <div class="collapsible-item">
                Reservation date
                <div>[[item.date]]</div>
              </div>
              <div class="collapsible-item">
                Reservation time
                <div>[[item.fromTime]] - [[item.toTime]]</div>
              </div>
            </div>
          </div>
        </template>
      </iron-list>
    </template>

    <!-- options dialog -->
    <paper-dialog id="optionsDialog" with-backdrop>
      <paper-menu selected="0">
        <paper-icon-item dialog-confirm on-tap="_removeItem">
          <iron-icon icon="icons:remove-circle" item-icon></iron-icon>Remove
        </paper-icon-item>
        <paper-icon-item dialog-dismiss on-tap="_dismissOptions">
          <iron-icon icon="icons:close" item-icon></iron-icon>Close
        </paper-icon-item>
      </paper-menu>
    </paper-dialog>
    <!-- <template is="dom-if" if="[[_isOptionsOpened]]" restamp="true" strip-whitespace>
    </template> -->

    <!-- toast -->
    <paper-toast id="reserveToast" text="[[_msg]]">
      <span role="button" tabindex="0" on-tap="_undoItemRemoval" hidden$="[[_hideUndo]]">Undo</span>
    </paper-toast>
    <!-- <template is="dom-if" if="[[_isToastOpened]]" restamp="true" strip-whitespace>
    </template> -->
  </template>

  <script src="reserve-list.js"></script>
</dom-module>
