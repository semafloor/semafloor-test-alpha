<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="semafloor-test-icons.html">

<link rel="import" href="../../bower_components/app-layout/app-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">

<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/paper-badge/paper-badge.html">
<!--
<link rel="import" href="../../bower_components/semafloor-profile-page/semafloor-profile-page.html">
<link rel="import" href="../../bower_components/semafloor-search-page/semafloor-search-page.html">
<link rel="import" href="../../bower_components/semafloor-current-page/semafloor-current-page.html">
<link rel="import" href="../../bower_components/semafloor-room-page/semafloor-room-page.html">
-->
<link rel="import" href="../../bower_components/semafloor-reserve-page/semafloor-reserve-page.html">
<script src="../../bower_components/lodash/lodash.min.js"></script>

<dom-module id="semafloor-test">
  <template>
    <style>
      :host {
        display: block;
        box-sizing: border-box;
        user-select: none;
      }

      app-header {
        background-color: #fff;
        color: #009688;
      }
      [title] {
        color: #009688;
        font-size: 20px;
        font-weight: 300;
        margin-left: 8px;
      }

      paper-tabs {
        background-color: #009688;
        color: #fff;
        height: 64px;

        --paper-tabs-selection-bar: {
          height: 3px;
        };
      }
      paper-tab {
        --paper-tab-ink: rgba(255, 255, 141, 0.5);
        text-transform: uppercase;
      }
      paper-tab.iron-selected {
        color: #FFFF8D;
      }
      paper-badge {
        --paper-badge-margin-left: -6px;
        --paper-badge-background: #FFFF8D;
        --paper-badge-text-color: #004D40;
      }
      paper-badge[for=thisweekTab] {
        --paper-badge-margin-bottom: 16px;
      }

      /* workaround to hide fake toolbar */
      /*app-drawer-layout {
        --app-drawer-layout-narrow-drawer: {
          z-index: 2;
        };
      }
      app-drawer-layout::content app-scrim {
        z-index: 2;
      }*/
      /*.fake-toolbar {
        height: 64px;
        z-index: 0;
        pointer-events: none;
        visibility: hidden;
      }*/

      /*app-header {
        --app-header-front-background: {
          background-color: #009688;
        };
        --app-header-back-background: {
          background-color: #fff;
        };
      }*/

    </style>

    <app-drawer-layout>
      <app-header-layout drawer>
      </app-header-layout>

      <app-header-layout main>
        <app-header condenses reveals effects="waterfall">
          <app-toolbar>
            <paper-icon-button icon="test:menu" drawer-toggle></paper-icon-button>
            <span title>Room Information</span>
          </app-toolbar>
          <app-toolbar hidden$="[[!_isReserve(category)]]">
            <paper-tabs id="fakeTabs" selected="{{tab}}" attr-for-selected="name" on-transitionend="_onTransitionend" on-iron-select="_onIronSelect" bottom-item>
              <paper-tab name="today">
                <span id="todayTab">today</span>
                <paper-badge for="todayTab" label="[[todayCount]]"></paper-badge>
              </paper-tab>
              <paper-tab name="thisweek">
                <!-- according to MD's specs, split long sentence into two lines -->
                <span>this<br><span id="thisweekTab">week</span></span>
                <paper-badge for="thisweekTab" label="[[thisweekCount]]"></paper-badge>
              </paper-tab>
              <paper-tab name="upcoming">
                <span id="upcomingTab">upcoming</span>
                <paper-badge for="upcomingTab" label="[[upcomingCount]]"></paper-badge>
              </paper-tab>
            </paper-tabs>
          </app-toolbar>
          <!-- <div class="fake-toolbar" hidden$="[[!_isReserve(category)]]"></div> -->
        </app-header>

        <!-- 57 nodes index.html -->
        <!-- 22 nodes shell -->
        <!-- 93 nodes profile -->

        <!-- 69 nodes index.html on FF -->
        <!-- 25 nodes shell on FF -->
        <!-- 92 nodes profile on FF -->
        <!-- 261 nodes reserve on FF -->
        <!-- 940 nodes search on FF -->
        <!-- 88 nodes current on FF -->
        <!-- 86 nodes room on FF -->
        <!-- 1252 nodes profile + reserve + search + current on FF -->

        <!-- 59 nodes index.html on CH/ OP -->
        <!-- 25 nodes shell on CH/ OP -->
        <!-- 92 nodes profile on CH/ OP -->
        <!-- 261 nodes reserve on CH/ OP -->
        <!-- 938 nodes search on CH/ OP -->
        <!-- 86 nodes current on CH/ OP -->
        <!-- 86 nodes room on CH/ OP -->
        <!-- 1250 nodes profile + reserve + search + current on CH/ OP -->


        <!--
        <semafloor-profile-page></semafloor-profile-page>
        <semafloor-search-page></semafloor-search-page>
        <semafloor-current-page></semafloor-current-page>
        <semafloor-room-page></semafloor-room-page>
        -->
        <semafloor-reserve-page id="reserve" selected-tab="{{tab}}" today-count="{{todayCount}}" thisweek-count="{{thisweekCount}}" upcoming-count="{{upcomingCount}}"></semafloor-reserve-page>
      </app-header-layout>
    </app-drawer-layout>
  </template>
  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'semafloor-test',

      properties: {
        category: {
          type: String,
          value: 'reserve'
        },
        tab: {
          type: String,
          value: 'today'
        },
      },

      'created': function() {
        console.time('profile-page-attached');
      },

      _isReserve: function(_category) {
        return _category === 'reserve';
      },
      _onTransitionend: function(ev) {
        if (ev.target.tagName !== 'PAPER-RIPPLE') {
          return;
        }

        this.$.reserve.onTransitionend(ev);
      },
      _onIronSelect: function() {
        this.$.reserve.onIronSelect();
      },

      // _onAppHeaderTransform: function(ev) {
      //   if (this.category === 'reserve') {
      //     // console.log('scrolling...', ev.detail.progress);
      //     this.$.reserve.condenseTabs(ev.detail.progress);
      //   }
      // },

    });
  })();
  </script>
</dom-module>
